# Crypto
## variable
> 据说初中生更加擅长crypto的破解，为了夺回本科生的尊严，你向初中小A发起了挑战

给了一份用于加密的py文件和密文txt文件
```python
import random

flag = 'flag{XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX}'
a = random.randint(1, 9999999999)
b = random.randint(1, 9999999999)
c = random.randint(1, 9999999999)
d = random.randint(1, 9999999999)
enc = []
for x in flag:
    res = (a * pow(ord(x), 3) + b * pow(ord(x), 2) + c * ord(x) + d)
    enc.append(res)
print(enc)
```
```python
[5699462831574115, 6762178137517177, 4904006952609865, 5868227804276587, 9978816733414447, 2555804598727387, 7339798412634739, 9038863758685179, 4607800653388515, 8591875579876765, 4607800653388515, 2012199806528365, 761800081770865, 8813480590313107, 718942790851879, 4607800653388515, 8374016791281969, 6040291893502029, 5533965039300429, 4607800653388515, 4904006952609865, 5056755384110247, 6215687035344625, 6762178137517177, 638111591795929, 3189435100987729, 9501092313613249, 4607800653388515, 8374016791281969, 7339798412634739, 4607800653388515, 1622988744649015, 7949410135240279, 9501092313613249, 7539405133434565, 8374016791281969, 600073811470597, 196738654989577, 10472292506842245]
```

是一个多项式的加密，主要是找到系数a,b,c,d的值。下面是解题脚本。
```python
import numpy as np
import sympy as sp

left = np.array([[pow(ord('f'), 3), pow(ord('f'), 2), ord('f'), 1],
                 [pow(ord('l'), 3), pow(ord('l'), 2), ord('l'), 1],
                 [pow(ord('a'), 3), pow(ord('a'), 2), ord('a'), 1],
                 [pow(ord('g'), 3), pow(ord('g'), 2), ord('g'), 1]])
right = np.array([5699462831574115, 6762178137517177, 4904006952609865, 5868227804276587]).T

coe = np.linalg.solve(left, right)
print(coe)

a, b, c, d = coe

cipher = [5699462831574115, 6762178137517177, 4904006952609865, 5868227804276587, 9978816733414447, 2555804598727387,
          7339798412634739, 9038863758685179, 4607800653388515, 8591875579876765, 4607800653388515, 2012199806528365,
          761800081770865, 8813480590313107, 718942790851879, 4607800653388515, 8374016791281969, 6040291893502029,
          5533965039300429, 4607800653388515, 4904006952609865, 5056755384110247, 6215687035344625, 6762178137517177,
          638111591795929, 3189435100987729, 9501092313613249, 4607800653388515, 8374016791281969, 7339798412634739,
          4607800653388515, 1622988744649015, 7949410135240279, 9501092313613249, 7539405133434565, 8374016791281969,
          600073811470597, 196738654989577, 10472292506842245]

x = sp.Symbol('x')
f = a * x ** 3 + b * x ** 2 + c * x + d
for c in cipher:
    res = sp.solve(f - c)
    print(chr(round(res[0])), end='')
```
最后解出来的flag为flag{Now_u_H4v3_the_abil1Ty_to_Crypt0!}